import binascii

from validate_ecc import validate_tag


def _validate_sig(uid, sig):
  uid_b = binascii.unhexlify(uid)
  sig_b = binascii.unhexlify(sig)
  return validate_tag(uid_b, sig_b)


def test_original():
  assert _validate_sig("047728824D6580", "9C7068636A285FEBA1E2406654009DCE6E8A9C9CE318BE0262ED162519B970B32FB802858420D667D12CEBCD32BB4BC8AFE21C753A5A6C26")
  assert _validate_sig("041D3C8A2D6B80", "A438FEB368DC45F9B8899C2926A985BE5D08E342CE016E9F08F3FDAE388BB4D6B3DFD7DEA2E1977CCD2E4C9F82F245D4DE08FB7FCB8043E3")
  assert _validate_sig("041C3C8A2D6B80", "B46D0539F65330E0D3C262FD6971C2E1DE1B609E68E2D003903FAAFCC0A4AC6DB78C638A85247FE5AD2AD535105B5CF0422143BF2817B862")
  assert _validate_sig("042428824D6580", "7DC7EDA4552D23DF3D90E36E4ABCB8C116D971D7162596C00B5D1F6A4EFF0FBE562D19B7C95D6582F0DA74B43EFD2DB36CD4A1451CE88330")
  assert _validate_sig("041B3C8A2D6B80", "B45769ECEBA64DFE6E72F1228AE05CC362A06216DAA8313A57CCE995135F423AFCDEAECFEE935B89EA8F4DDEA9F669A19C575AD8F7EA7432")
  assert _validate_sig("047D28824D6580", "B5CEC77F9CAD333EBE8CE58CE6D71E56B1A46E4A6BD3F6A4D244B9F2688AB823892F79088600568CA9E30F4393728B3573B6D98D4121EC4D")


def test_invalid_random():
  assert not _validate_sig("21A6D8FD5528D3", "8172EFBA10E1884E49536FC21EAD1AE55AF08A1423DBE43C8364C456534694BCEF0BF85BF329A0FF8B221013AF860976AB029155BD95BBCE")
  assert not _validate_sig("A53CCF5630EF30", "B4E99035A8A6244EB77B70EEA500C89C9FA1EB334DDDC9755C2AA48FA319C9B92829F3CF5E51BB8B18C53ABCE5572DFF0C4C407BFDC43388")
  assert not _validate_sig("88CF1A5F920205", "254BD696E570AD75781415F95C5C3ECDC8A79B8184BA9D82251B19CFC4D0DFAFA9662F78A3E965F6424A19D419837C241CB5B559784CD154")


def test_invalid_flip():
  assert not _validate_sig("047728824D6580", "9C7068636A285FEBA1E2406654009DCE6E8A9C9CE318BE0262ED162519B970B32FB802858420D667D12CEBCD32BB4BC8AFE21C753A5A6C25")
  assert not _validate_sig("041D3C8A2D6B80", "A438FEB368DC45F9B8899C2926A985BE5D08E342CE016E9F08F3FDAE388BB4D6B3DFD7DEA2E1977CCD2E4C9F82F245D4DE08FB7FCB8043E2")
  assert not _validate_sig("041C3C8A2D6B80", "B46D0539F65330E0D3C262FD6971C2E1DE1B609E68E2D003903FAAFCC0A4AC6DB78C638A85247FE5AD2AD535105B5CF0422143BF2817B861")
  assert not _validate_sig("042428824D6580", "7DC7EDA4552D23DF3D90E36E4ABCB8C116D971D7162596C00B5D1F6A4EFF0FBE562D19B7C95D6582F0DA74B43EFD2DB36CD4A1451CE8833F")
  assert not _validate_sig("041B3C8A2D6B80", "B45769ECEBA64DFE6E72F1228AE05CC362A06216DAA8313A57CCE995135F423AFCDEAECFEE935B89EA8F4DDEA9F669A19C575AD8F7EA7431")
  assert not _validate_sig("047D28824D6580", "B5CEC77F9CAD333EBE8CE58CE6D71E56B1A46E4A6BD3F6A4D244B9F2688AB823892F79088600568CA9E30F4393728B3573B6D98D4121EC4E")
